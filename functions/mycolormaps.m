function map = lbmap(varargin)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Arguments: 
% 
% Usage:
% 
% color = mycolormaps('num',20,'scheme','darkredblue')
% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Palettes included:
%-------------------------------------------------------------------------------------------
% redblue
% bluelight
% lightblue
% lightredblue
% softredblue
% lightredblue1
% lightredblue2
% darkredblue
% darkredblue_nowhite
% jet
% jet_reversed
% jet1
% jet2
% jet3
% magicjet
% magicjet1
% seis_reversed
% bluyelred
% redyelblu
% redyelblu2
% redyelblu3
% bcyr
% darkpanoply
% panoply
% panoply2
% bw
% bw1
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% History:
% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% default arguments:
A.num	        = 20;
A.scheme        = 'salt';
% Parse required variables, substituting defaults where necessary
A = parse_pv_pairs(A, varargin);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

A.scheme = lower(A.scheme);

switch A.scheme
%-----------------------------------------------------------
case 'redblue'
basemap = [
           7, 30, 70
           7, 30, 70
           7, 47,107
           7, 47,107
           8, 82,156
           8, 82,156
          33,113,181
          33,113,181
          66,146,199
          66,146,199
          90,160,205
          90,160,205
         120,191,214
         120,191,214
         170,220,230
         170,220,230
         219,245,255
         219,245,255
         240,252,255
         240,252,255
         255,240,245
         255,240,245
         255,224,224
         255,224,224
         252,187,170
         252,187,170
         252,146,114
         252,146,114
         251,106, 74
         251,106, 74
         240, 60, 43
         240, 60, 43
         204, 24, 30
         204, 24, 30
         166, 15, 20
         166, 15, 20
         120, 10, 15
         120, 10, 15
          95,  0,  0
          95,  0,  0
          ]/255;
%-----------------------------------------------------------
case 'redblue_nowhite_light'
basemap = [
           7, 47,107
           7, 47,107
           8, 82,156
           8, 82,156
          33,113,181
          33,113,181
          66,146,199
          66,146,199
          90,160,205
          90,160,205
         120,191,214
         120,191,214
         170,220,230
         170,220,230
         219,245,255
         219,245,255
         240,252,255
         240,252,255
         255,240,245
         255,240,245
         255,224,224
         255,224,224
         252,187,170
         252,187,170
         252,146,114
         252,146,114
         251,106, 74
         251,106, 74
         240, 60, 43
         240, 60, 43
         204, 24, 30
         204, 24, 30
         166, 15, 20
         166, 15, 20
         120, 10, 15
         120, 10, 15
          ]/255;
 basemap(17:20,:) = [];
%-----------------------------------------------------------
case 'redblue_nowhite'
basemap = [
           7, 30, 70
           7, 30, 70
           7, 47,107
           7, 47,107
           8, 82,156
           8, 82,156
          33,113,181
          33,113,181
          66,146,199
          66,146,199
          90,160,205
          90,160,205
         120,191,214
         120,191,214
         170,220,230
         170,220,230
         219,245,255
         219,245,255
         240,252,255
         240,252,255
         255,240,245
         255,240,245
         255,224,224
         255,224,224
         252,187,170
         252,187,170
         252,146,114
         252,146,114
         251,106, 74
         251,106, 74
         240, 60, 43
         240, 60, 43
         204, 24, 30
         204, 24, 30
         166, 15, 20
         166, 15, 20
         120, 10, 15
         120, 10, 15
          95,  0,  0
          95,  0,  0
          ]/255;
 basemap(19:22,:) = [];
%-----------------------------------------------------------
case 'blured_short'
basemap = [ [linspace(0,0.8,10)' linspace(0,0.8,10)' linspace(0.7,1.0,10)'] ; ...
            rot90([linspace(0,0.8,10)' linspace(0,0.8,10)' linspace(0.7,1.0,10)'],2) ];
basemap = flipud(basemap);
%-----------------------------------------------------------
case 'blured_short2'
basemap = [ [linspace(0,0.8,15)' linspace(0,0.8,15)' linspace(0.7,1.0,15)'] ; ...
            rot90([linspace(0,0.8,15)' linspace(0,0.8,15)' linspace(0.7,1.0,15)'],2) ];
basemap(14:17,:) = [];
basemap = flipud(basemap);
%-----------------------------------------------------------
case 'bluredgreen_short'
basemap = [ 
            [linspace(0.0,0.0,20)' linspace(1.0,0.0,20)' linspace(0.0,0.7,20)'] ; ...
            [linspace(0,0.8,10)' linspace(0,0.8,10)' linspace(0.7,1.0,10)'] ; ...
            rot90([linspace(0,0.8,10)' linspace(0,0.8,10)' linspace(0.7,1.0,10)'],2)
           ];
basemap = flipud(basemap);
%-----------------------------------------------------------
case 'bluelight'
basemap = [
           247 247 247
           209 229 240
           209 229 240
           146 197 222
           146 197 222
            67 147 195
            67 147 195
            33 102 172
            33 102 172
             5  48  97
             5  48  97
          ]/255;

%basemap = flipud(basemap);
%-----------------------------------------------------------
case 'lightblue'
basemap = [
           247 247 247
           209 229 240
           209 229 240
           146 197 222
           146 197 222
            67 147 195
            67 147 195
            33 102 172
            33 102 172
             5  48  97
             5  48  97
          ]/255;

basemap = flipud(basemap);
%-----------------------------------------------------------
case 'lightredblue'
basemap = [
           103   0  31
           103   0  31
           178  24  43
           178  24  43
           214  96  77
           214  96  77
           244 165 130
           244 165 130
           253 219 199
           253 219 199
           247 247 247
           247 247 247
           209 229 240
           209 229 240
           146 197 222
           146 197 222
            67 147 195
            67 147 195
            33 102 172
            33 102 172
             5  48  97
             5  48  97
          ]/255;

basemap = flipud(basemap);
%-----------------------------------------------------------
case 'softredblue'
basemap = [
           214  96  77
           214  96  77
           244 165 130
           244 165 130
           253 219 199
           253 219 199
           247 247 247
           247 247 247
           209 229 240
           209 229 240
           146 197 222
           146 197 222
            67 147 195
            67 147 195
            33 102 172
            33 102 172
             5  48  97
             5  48  97
          ]/255;

basemap = flipud(basemap);
%-----------------------------------------------------------
case 'softredblue2'
basemap = [
           7, 47,107
           7, 47,107
           8, 82,156
           8, 82,156
          33,113,181
          33,113,181
          66,146,199
          66,146,199
          90,160,205
          90,160,205
         120,191,214
         120,191,214
         170,220,230
         170,220,230
         219,245,255
         219,245,255
         240,252,255
         240,252,255
         255,240,245
         255,240,245
         255,224,224
         255,224,224
         252,187,170
         252,187,170
         252,146,114
         252,146,114
         251,106, 74
         251,106, 74
         240, 60, 43
         240, 60, 43
         204, 24, 30
         204, 24, 30
         166, 15, 20
         166, 15, 20
         120, 10, 15
         120, 10, 15
          ]/255;
%-----------------------------------------------------------
case 'lightredblue1'
basemap = [
    0.1294    0.4000    0.6745
    0.1961    0.4882    0.7196
    0.2627    0.5765    0.7647
    0.4176    0.6745    0.8176
    0.5725    0.7725    0.8706
    0.6961    0.8353    0.9059
    0.8196    0.8980    0.9412
    0.8941    0.9333    0.9549
    0.9804    0.9137    0.8745
    0.9922    0.8588    0.7804
    0.9745    0.7529    0.6451
    0.9569    0.6471    0.5098
    0.8980    0.5118    0.4059
    0.8392    0.3765    0.3020
    0.7686    0.2353    0.2353
    0.6980    0.0941    0.1686
          ];
%-----------------------------------------------------------
case 'lightredblue2'
basemap = [
    0.0196    0.1882    0.3804
    0.0539    0.2544    0.4723
    0.1294    0.4000    0.6745
    0.2544    0.5654    0.7591
    0.3402    0.6255    0.7912
    0.5725    0.7725    0.8706
    0.7887    0.8824    0.9324
    0.8475    0.9113    0.9463
    0.9877    0.8794    0.8157
    0.9877    0.8324    0.7466
    0.9569    0.6471    0.5098
    0.8686    0.4441    0.3539
    0.8304    0.3588    0.2936
    0.6980    0.0941    0.1686
    0.4958    0.0294    0.1363
    0.4039         0    0.1216
          ];

%-----------------------------------------------------------
case 'darkredblue'
basemap = [
           103   0  31
           103   0  31
           178  24  43
           178  24  43
           214  96  77
           214  96  77
           244 165 130
           244 165 130
           253 219 199
           253 219 199
           247 247 247
           247 247 247
           209 229 240
           209 229 240
           146 197 222
           146 197 222
            67 147 195
            67 147 195
            33 102 172
            33 102 172
             5  48  97
             5  48  97
          ]/255;

basemap = flipud(basemap);

 XX = [-1:1/10.5:1];
 DX = 0.4;
 HH = 0.8;
 EE = 2.0;
 YY = (1-HH) * (DX^EE)./(DX.^EE+XX.^EE) + HH;
 darkener = repmat(YY(:),1,3);

basemap = basemap .* darkener;

%-----------------------------------------------------------
case 'darkredblue_nowhite'
basemap = [
           103   0  31
           103   0  31
           178  24  43
           178  24  43
           214  96  77
           214  96  77
           244 165 130
           244 165 130
           253 219 199
           209 229 240
           146 197 222
           146 197 222
            67 147 195
            67 147 195
            33 102 172
            33 102 172
             5  48  97
             5  48  97
          ]/255;

basemap = flipud(basemap);

 XX = [-1:1/8.5:1];
 DX = 0.4;
 HH = 0.8;
 EE = 2.0;
 YY = (1-HH) * (DX^EE)./(DX.^EE+XX.^EE) + HH;
 darkener = repmat(YY(:),1,3);

basemap = basemap .* darkener;
%-----------------------------------------------------------
case 'darkredblue_nowhite3'
basemap = [
           103   0  31
           178  24  43
           178  24  43
           214  96  77
           214  96  77
           244 165 130
           244 165 130
           253 219 199
           209 229 240
           146 197 222
           146 197 222
            67 147 195
            67 147 195
            33 102 172
            33 102 172
             5  48  97
          ]/255;

basemap = flipud(basemap);

 XX = [-1:1/7.5:1];
 DX = 0.4;
 HH = 1.2;
 EE = 2.0;
 YY = (1-HH) * (DX^EE)./(DX.^EE+XX.^EE) + HH;
 darkener = repmat(YY(:),1,3);

basemap = basemap .* darkener;
%-----------------------------------------------------------
case 'darkredblue_nowhite4'
basemap = [
           103   0  31
           103   0  31
           178  24  43
           178  24  43
           214  96  77
           214  96  77
           244 165 130
           244 165 130
            67 147 195
            67 147 195
            33 102 172
            33 102 172
             5  48  97
             5  48  97
          ]/255;

basemap = flipud(basemap);

 XX = [-1:1/((size(basemap,1)-1)/2):1];
 DX = 0.4;
 HH = 0.8;
 EE = 2.0;
 YY = (1-HH) * (DX^EE)./(DX.^EE+XX.^EE) + HH;
 darkener = repmat(YY(:),1,3);

basemap = basemap .* darkener;

basemap(end-1:end,:) = [];

%-----------------------------------------------------------
case 'jet'
basemap = jet(16);
%-----------------------------------------------------------
case 'jet_reversed'
basemap = flipud(jet(16));
%-----------------------------------------------------------
case 'jetfirstwhite'
basemap = jet(A.num);
basemap(1,:) = [1 1 1];
%-----------------------------------------------------------
case 'magicjet'

basemap = jet(16);

 XX = [-1:1/7.5:1];
 DX = 0.3;
 HH = 0.7;
 EE = 2.0;
 YY  = (1-HH) * (DX^EE)./(DX.^EE+XX.^EE) + HH;
 darkener   = repmat(YY(:),1,3);
 darkener1 = darkener;
 darkener1(:,1) = ones(size(darkener(:,1))); 
 darkener1(:,3) = ones(size(darkener(:,1))); 

 basemap = basemap .* darkener1;
%-----------------------------------------------------------
case 'jet1'
basemap = [
           0   0 191 
           0   0 255 
           0  63 255 
           0 127 255 
           0 191 255 
           0 255 255 
          63 255 255 
         127 255 191 
         191 255 127 
         255 255  63 
         255 255   0 
         255 191   0 
         255 127   0 
         255  63   0 
         255   0   0 
         191   0   0
          ]/255;
%-----------------------------------------------------------
case 'magicjet1'
basemap = [
           0   0 191 
           0   0 255 
           0  63 255 
           0 127 255 
           0 191 255 
           0 255 255 
          63 255 255 
         127 255 191 
         191 255 127 
         255 255  63 
         255 255   0 
         255 191   0 
         255 127   0 
         255  63   0 
         255   0   0 
         191   0   0
          ]/255;

 XX = [-1:1/7.5:1];
 DX = 0.2;
 HH = 0.8;
 EE = 2.0;
 YY = (1-HH) * (DX^EE)./(DX.^EE+XX.^EE) + HH;
 darkener  = repmat(YY(:),1,3);
 darkener1 = darkener;
 darkener1(:,1) = ones(size(darkener(:,1))); 
 darkener1(:,3) = ones(size(darkener(:,1))); 

 basemap = basemap .* darkener1;

%-----------------------------------------------------------
case 'seis_reversed'
basemap = [
           170   0   0
           255   0   0
           255  85   0
           255 170   0
           255 255   0
           255 255   0
            90 255  30
             0 240 110
             0  80 255
             0   0 205
      ]/255;
basemap = flipud(basemap);
%-----------------------------------------------------------
case 'jet2'
basemap = [
         0         0    0.7500
         0         0    0.9844
         0    0.2188    1.0000
         0    0.4531    1.0000
         0    0.6875    1.0000
         0    0.9219    1.0000
    0.1563    1.0000    0.8437
    0.3906    1.0000    0.6094
    0.8594    1.0000    0.1406
    1.0000    0.9062         0
    1.0000    0.6719         0
    1.0000    0.4375         0
    1.0000    0.2031         0
    0.9688         0         0
    0.7344         0         0
    0.5000         0         0
      ];

%-----------------------------------------------------------
case 'jet3'
basemap = [
         0         0    0.7500
         0         0    0.8634
         0         0    0.9768
         0    0.0988    0.9914
         0    0.2047    0.9990
         0    0.3171    1.0000
         0    0.4304    1.0000
         0    0.5438    1.0000
         0    0.6573    1.0000
         0    0.7707    1.0000
         0    0.8841    1.0000
    0.0504    0.9471    0.9496
    0.1260    0.9849    0.8740
    0.2243    1.0000    0.7757
    0.3377    1.0000    0.6623
    0.5116    1.0000    0.4884
    0.7384    1.0000    0.2616
    0.8911    0.9788    0.1089
    0.9592    0.9334    0.0408
    1.0000    0.8609         0
    1.0000    0.7475         0
    1.0000    0.6341         0
    1.0000    0.5207         0
    1.0000    0.4073         0
    1.0000    0.2938         0
    0.9970    0.1834         0
    0.9819    0.0852         0
    0.9537         0         0
    0.8403         0         0
    0.7268         0         0
    0.6134         0         0
    0.5000         0         0
      ];

 XX  = [-1:1/15.5:1]';
 XX1 = [-1:1/31:0]';
 XX2 = [0:1/31:1]';
 XXX1 = -abs(XX1.^2);
 XXX2 = +abs(XX2.^2);

 basemap(:,1) = basemap(:,1) - 0.1 * XXX1;
 basemap(:,3) = basemap(:,3) + 0.1 * XXX2;
 basemap(:,2) = basemap(:,2) - 0.0 * XX1;

 DX = 0.2;
 HH = 0.8;
 EE = 8.0;
 YY = real((1-HH) * (DX^EE)./(DX.^EE+XX.^EE) + HH);
 darkener  = repmat(YY(:),1,3);
 darkener1 = darkener;
 darkener1(:,1) = ones(size(darkener(:,1)));
 darkener1(:,3) = ones(size(darkener(:,1)));

 desaturate = 0.05 + zeros(size(basemap));

 basemap = basemap + desaturate;
 basemap = basemap .* darkener1 + desaturate;

 basemap(basemap>1.0) = 1.0;
 basemap(basemap<0.0) = 0.0;

%-----------------------------------------------------------
case 'jet2'
basemap = [
         0         0    0.7500
         0         0    0.9844
         0    0.2188    1.0000
         0    0.4531    1.0000
         0    0.6875    1.0000
         0    0.9219    1.0000
    0.1563    1.0000    0.8437
    0.3906    1.0000    0.6094
    0.8594    1.0000    0.1406
    1.0000    0.9062         0
    1.0000    0.6719         0
    1.0000    0.4375         0
    1.0000    0.2031         0
    0.9688         0         0
    0.7344         0         0
    0.5000         0         0
      ];

%-----------------------------------------------------------
case 'seis'
basemap = [
           170   0   0
           255   0   0
           255  85   0
           255 170   0
           255 255   0
           255 255   0
            90 255  30
             0 240 110
             0  80 255
             0   0 205
      ]/255;
%-----------------------------------------------------------
case 'bluyelred'
basemap = [
           165,  0, 38
           165,  0, 38
           215, 48, 39
           215, 48, 39
           244,109, 67
           244,109, 67
           253,174, 97
           253,174, 97
           254,224,144
           254,224,144
           255,255,191
           255,255,191
           224,243,248
           224,243,248
           171,217,233
           171,217,233
           116,173,209
           116,173,209
            69,117,180
            69,117,180
            49, 54,149
            49, 54,149
          ]/255;
%-----------------------------------------------------------
case 'redyelblu'
basemap = [
    0.1922    0.2118    0.5843
    0.2412    0.3662    0.6603
    0.3167    0.5137    0.7343
    0.4319    0.6510    0.8054
    0.5627    0.7647    0.8667
    0.6966    0.8637    0.9211
    0.8265    0.9275    0.9578
    0.9240    0.9706    0.8887
    1.0000    1.0000    0.7490
    0.9975    0.9240    0.6338
    0.9951    0.8294    0.5186
    0.9926    0.7069    0.4034
    0.9745    0.5549    0.3216
    0.9426    0.3975    0.2490
    0.8716    0.2480    0.1804
    0.7696    0.1176    0.1515
    0.6471    0.0000    0.1490
          ];
%-----------------------------------------------------------
case 'redyelblu3'
basemap = [
      158,	  1,		 66
      158,	  1,		 66
      213,	 62,		 79
      213,	 62,		 79
      244,	109,		 67
      244,	109,		 67
      253,	174,		 97
      253*1.0,	174*1.0,	 97
      254*1.0,	224*1.0,	139
      254*0.99,	224*0.99,	139*0.8
      255*0.98,	255*0.98,	191*0.6
      255*0.97,	255*0.97,	191*0.6
      230*0.96,	245*0.96,	152*0.5
      230*0.97,	245*0.97,	152*0.6
      171*0.98,	221*0.98,	164*0.6
      171*0.99,	221*0.99,   	164*0.8
      102,	194,		165
      102,	194,		165
       50,	136,		189
       50,	136,		189
       94,	 79,		162
       94,	 79,		162
          ]/256;
 basemap = flipud(basemap);
%-----------------------------------------------------------
case 'redyelblu2'
basemap = [
    0.2358    0.3490    0.6519
    0.2959    0.4727    0.7138
    0.3818    0.5897    0.7737
    0.4838    0.6938    0.8287
    0.5928    0.7851    0.8780
    0.7031    0.8612    0.9201
    0.8076    0.9176    0.9390
    0.8956    0.9578    0.9035
    0.9968    0.8965    0.6018
    0.9948    0.8119    0.5058
    0.9900    0.7086    0.4156
    0.9769    0.5881    0.3408
    0.9525    0.4592    0.2775
    0.9102    0.3316    0.2196
    0.8431    0.2118    0.1726
    0.7560    0.1045    0.1512
          ];
%-----------------------------------------------------------
case 'bcyr'
basemap = [
            0   0 255 
            0 255 255
            255 255   0
            255   0   0
          ]/255;
%-----------------------------------------------------------
case 'darkpanoply'
basemap = [
	4	14	216
	32	80	255
	65	150	255
	109	193	255
	134	217	255
	156	238	255
	175	245	255
	206	255	255
	255	254	71	
	255	235	0	
	255	196	0	
	255	144	0	
	255	72	0
	255	0	0
	213	0	0
	158	0	0
          ]/255;

 XX = [-1:1/7.5:1];
 DX = 0.2;
 HH = 0.9;
 EE = 2.0;
 YY = (1-HH) * (DX^EE)./(DX.^EE+XX.^EE) + HH;
 darkener = real(repmat(YY(:),1,3));

basemap = basemap .* darkener;

%-----------------------------------------------------------
case 'panoply2'
basemap = [
    0.0157    0.0549    0.8471
    0.1186    0.2975    0.9904
    0.2387    0.5539    1.0000
    0.3951    0.7252    1.0000
    0.5010    0.8275    1.0000
    0.5848    0.9076    1.0000
    0.6583    0.9505    1.0000
    0.7547    0.9828    1.0000
    1.0000    0.9635    0.1566
    1.0000    0.8642         0
    1.0000    0.7049         0
    1.0000    0.4941         0
    1.0000    0.2294         0
    0.9794         0         0
    0.8218         0         0
    0.6196         0         0
          ];
%-----------------------------------------------------------
case 'panoply'
basemap = [
	4	14	216
	32	80	255
	65	150	255
	109	193	255
	134	217	255
	156	238	255
	175	245	255
	206	255	255
	255	254	71	
	255	235	0	
	255	196	0	
	255	144	0	
	255	72	0
	255	0	0
	213	0	0
	158	0	0
          ]/255;

%-----------------------------------------------------------
case 'bw'
basemap = [
         0         0         0
    0.0667    0.0667    0.0667
    0.1333    0.1333    0.1333
    0.2000    0.2000    0.2000
    0.2667    0.2667    0.2667
    0.3333    0.3333    0.3333
    0.4000    0.4000    0.4000
    0.4667    0.4667    0.4667
    0.5333    0.5333    0.5333
    0.6000    0.6000    0.6000
    0.6667    0.6667    0.6667
    0.7333    0.7333    0.7333
    0.8000    0.8000    0.8000
    0.8667    0.8667    0.8667
    0.9333    0.9333    0.9333
    1.0000    1.0000    1.0000
      ];
%-----------------------------------------------------------
case 'bw1'
basemap = [
    0.1053    0.1053    0.1053
    0.1579    0.1579    0.1579
    0.2105    0.2105    0.2105
    0.2632    0.2632    0.2632
    0.3158    0.3158    0.3158
    0.3684    0.3684    0.3684
    0.4211    0.4211    0.4211
    0.4737    0.4737    0.4737
    0.5263    0.5263    0.5263
    0.5789    0.5789    0.5789
    0.6316    0.6316    0.6316
    0.6842    0.6842    0.6842
    0.7368    0.7368    0.7368
    0.7895    0.7895    0.7895
    0.8421    0.8421    0.8421
    0.8947    0.8947    0.8947
      ];
%-----------------------------------------------------------
case 'ds9'
basemap = [
           0,  0,  0
           0,  0,255
          55,  0,  0
          55,255,  0
          55,255,255
      ];
%-----------------------------------------------------------
case 'none'
basemap = [
      ];
%-----------------------------------------------------------
case 'ferret'
basecmap = [...
    1 0 0
    1 .5 0
    1 1 0
    0 1 0    % Red, Orange, Yellow, Green
    0 1 1
    0 0 1
    .5 0 1
    1 0 1
    1 1 1];

basecmap = flipud(basecmap);
ncol = 20;

step = linspace(1, ncol, size(basecmap,1));

% Expand colormap to specified number of colors

cmap = interp1(step, basecmap, 1:ncol);

% For floating point problems
cmap(cmap > 1) = 1;
cmap(cmap < 0) = 0;
basemap = cmap;
%-----------------------------------------------------------
otherwise
error([A.scheme ' not found']);
end

idx1 = linspace(0,1,size(basemap,1));
idx2 = linspace(0,1,A.num);
map = interp1(idx1,basemap,idx2);

map(map<0) = 0;
map(map>1) = 1;



